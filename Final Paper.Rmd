---
title: "Final Paper"
author: "Juan Sanchez, Jared Picco"
date: "2023-12-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library(tidyverse)
library(dplyr)
library(plm)
library(ggplot2)
library(lmtest)
library(sandwich)
library(knitr)
library(broom)
library(readxl)
library(AER)
library(stargazer)
library(foreign)
library(Hmisc)
library(MatchIt)
library(mlogit)
```

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
movie_data <- read_excel("moviedata.xlsx")

movie_data$D <- ifelse(movie_data$week == "51"|movie_data$week =="52", 1,0)

# Subset the data to look at only the weeks we are interested in subsetting out the outliers
movie_data <- movie_data %>%
  filter(week == "51"|week =="52"|week =="50"|week =="49", revenue <= 	
296602355)


# Plot the data and fit the model seperately fit lines for weeks 49 and 50 and 51 and 52
ols_model <- lm(log(revenue) ~ I(week_num^2) + market_share + week, data = movie_data)

summary(ols_model)


ggplot(movie_data, aes(x = week, y = log(revenue))) +
  geom_point() +
  #geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "red") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "blue", data = subset(movie_data, week == "49"|week =="50")) +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "green", data = subset(movie_data, week == "51"|week =="52")) +
  labs(title = "Revenue by Week", x = "Week", y = "Revenue")




```










